<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparativo Europeu â€“ V3</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

<style>
:root{
  --bg:#0d1b2a;
  --card:#1b263b;
  --accent:#00aaff;
  --text:#e0e1dd;
  --muted:#9aa4b2;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  background:var(--bg);
  color:var(--text);
}
header{
  padding:16px;
  border-bottom:1px solid rgba(255,255,255,.1);
}
header h1{
  margin:0;
  color:var(--accent);
  font-size:1.2rem;
}
.controls{
  padding:12px;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
select{
  padding:10px 12px;
  border-radius:10px;
  border:none;
  background:var(--card);
  color:var(--text);
  font-size:.95rem;
}
.tabs{
  display:flex;
  padding:0 12px 12px;
  gap:8px;
}
.tab{
  flex:1;
  text-align:center;
  padding:10px;
  border-radius:10px;
  background:var(--card);
  cursor:pointer;
  opacity:.6;
}
.tab.active{
  opacity:1;
  background:var(--accent);
  color:#000;
  font-weight:600;
}
.section{
  padding:12px;
  display:grid;
  grid-template-columns:1fr;
  gap:12px;
}
@media(min-width:900px){
  .section{grid-template-columns:1fr 1fr}
}
.card{
  background:var(--card);
  border-radius:14px;
  padding:14px;
}
.card h2{
  margin:0 0 8px;
  font-size:.95rem;
  color:var(--accent);
}
.row{
  display:flex;
  align-items:center;
  gap:10px;
  margin:8px 0;
}
.label{width:180px;font-size:.85rem}
.bar{
  flex:1;
  height:10px;
  background:rgba(0,0,0,.2);
  border-radius:5px;
}
.fill{
  height:100%;
  border-radius:5px;
  background:var(--accent);
}
.value{
  width:70px;
  text-align:right;
  font-weight:600;
}
</style>
</head>

<body>

<header>
  <h1>Comparativo Europeu â€” V3</h1>
</header>

<div class="controls">
  <select id="mercado">
    <option value="mediaGols">MÃ©dia de gols</option>
    <option value="vitoriasMandante">VitÃ³rias do mandante</option>
    <option value="vitoriasVisitante">VitÃ³rias do visitante</option>
    <option value="empates">Empates</option>
    <option value="zeroZero">Jogos 0x0</option>

    <option value="over05">Over 0.5 gols</option>
    <option value="under05">Under 0.5 gols</option>
    <option value="over15">Over 1.5 gols</option>
    <option value="under15">Under 1.5 gols</option>
    <option value="over25">Over 2.5 gols</option>
    <option value="under25">Under 2.5 gols</option>
  </select>
</div>

<div class="tabs">
  <div class="tab active" data-periodo="FT">Tempo regulamentar</div>
  <div class="tab" data-periodo="HT">Primeiro tempo</div>
</div>

<div class="section">
  <div class="card">
    <h2 id="tituloPrincipal"></h2>
    <div id="rankingPrincipal"></div>
  </div>

  <div class="card">
    <h2 id="tituloSecundario"></h2>
    <div id="rankingSecundario"></div>
  </div>
</div>

<script>
const ligas = {
  bundesliga:{nome:'ðŸ‡©ðŸ‡ª ALEMANHA',url:'https://www.football-data.co.uk/mmz4281/2526/D1.csv'},
  bundesliga2:{nome:'ðŸ‡©ðŸ‡ª ALEMANHA-2',url:'https://www.football-data.co.uk/mmz4281/2526/D2.csv'},
  premier:{nome:'ðŸ‡¬ðŸ‡§ INGLATERRA',url:'https://www.football-data.co.uk/mmz4281/2526/E0.csv'},
  premier2:{nome:'ðŸ‡¬ðŸ‡§ INGLATERRA-2',url:'https://www.football-data.co.uk/mmz4281/2526/E1.csv'},
  laliga:{nome:'ðŸ‡ªðŸ‡¸ ESPANHA',url:'https://www.football-data.co.uk/mmz4281/2526/SP1.csv'},
  laliga2:{nome:'ðŸ‡ªðŸ‡¸ ESPANHA-2',url:'https://www.football-data.co.uk/mmz4281/2526/SP2.csv'},
  seriea:{nome:'ðŸ‡®ðŸ‡¹ ITÃLIA',url:'https://www.football-data.co.uk/mmz4281/2526/I1.csv'},
  seriea2:{nome:'ðŸ‡®ðŸ‡¹ ITÃLIA-2',url:'https://www.football-data.co.uk/mmz4281/2526/I2.csv'},
  ligue1:{nome:'ðŸ‡«ðŸ‡· FRANÃ‡A',url:'https://www.football-data.co.uk/mmz4281/2526/F1.csv'},
  ligue2:{nome:'ðŸ‡«ðŸ‡· FRANÃ‡A-2',url:'https://www.football-data.co.uk/mmz4281/2526/F2.csv'},
  eredivisie:{nome:'ðŸ‡³ðŸ‡± HOLANDA',url:'https://www.football-data.co.uk/mmz4281/2526/N1.csv'},
  portugal:{nome:'ðŸ‡µðŸ‡¹ PORTUGAL',url:'https://www.football-data.co.uk/mmz4281/2526/P1.csv'},
  scotland:{nome:'ðŸ´ó §ó ¢ó ³ó £ó ´ó ¿ ESCÃ“CIA',url:'https://www.football-data.co.uk/mmz4281/2526/SC0.csv'},
  belgium:{nome:'ðŸ‡§ðŸ‡ª BÃ‰LGICA',url:'https://www.football-data.co.uk/mmz4281/2526/B1.csv'},
  turkey:{nome:'ðŸ‡¹ðŸ‡· TURQUIA',url:'https://www.football-data.co.uk/mmz4281/2526/T1.csv'},
  greece:{nome:'ðŸ‡¬ðŸ‡· GRÃ‰CIA',url:'https://www.football-data.co.uk/mmz4281/2526/G1.csv'}
};

let dados=[];
let periodoAtivo='FT';

async function carregar(){
  dados=[];
  for(const k in ligas){
    const csv=await fetch('https://corsproxy.io/?'+encodeURIComponent(ligas[k].url)).then(r=>r.text());
    const parsed=Papa.parse(csv,{header:true});
    dados.push(calcular(parsed.data,ligas[k].nome));
  }
  render();
}

function calcular(rows,nome){
  const jogos=rows.filter(r=>r.FTR);
  let ft={g:0,vm:0,vv:0,e:0,z:0,o05:0,o15:0,o25:0},
      ht={g:0,vm:0,vv:0,e:0,z:0,o05:0,o15:0,o25:0};

  jogos.forEach(j=>{
    if(j.FTR==='H')ft.vm++; else if(j.FTR==='A')ft.vv++; else ft.e++;
    if(j.HTR==='H')ht.vm++; else if(j.HTR==='A')ht.vv++; else ht.e++;

    const ftg=(+j.FTHG)+(+j.FTAG);
    const htg=(+j.HTHG||0)+(+j.HTAG||0);

    ft.g+=ftg; ht.g+=htg;

    if(ftg===0)ft.z++;
    if(htg===0)ht.z++;

    if(ftg>=1)ft.o05++;
    if(ftg>=2)ft.o15++;
    if(ftg>=3)ft.o25++;

    if(htg>=1)ht.o05++;
    if(htg>=2)ht.o15++;
    if(htg>=3)ht.o25++;
  });

  const t=jogos.length;
  return{
    nome,
    FT:{
      mediaGols:(ft.g/t).toFixed(2),
      vitoriasMandante:(ft.vm/t*100).toFixed(1),
      vitoriasVisitante:(ft.vv/t*100).toFixed(1),
      empates:(ft.e/t*100).toFixed(1),
      zeroZero:(ft.z/t*100).toFixed(1),
      over05:(ft.o05/t*100).toFixed(1),
      under05:((t-ft.o05)/t*100).toFixed(1),
      over15:(ft.o15/t*100).toFixed(1),
      under15:((t-ft.o15)/t*100).toFixed(1),
      over25:(ft.o25/t*100).toFixed(1),
      under25:((t-ft.o25)/t*100).toFixed(1)
    },
    HT:{
      mediaGols:(ht.g/t).toFixed(2),
      vitoriasMandante:(ht.vm/t*100).toFixed(1),
      vitoriasVisitante:(ht.vv/t*100).toFixed(1),
      empates:(ht.e/t*100).toFixed(1),
      zeroZero:(ht.z/t*100).toFixed(1),
      over05:(ht.o05/t*100).toFixed(1),
      under05:((t-ht.o05)/t*100).toFixed(1),
      over15:(ht.o15/t*100).toFixed(1),
      under15:((t-ht.o15)/t*100).toFixed(1),
      over25:(ht.o25/t*100).toFixed(1),
      under25:((t-ht.o25)/t*100).toFixed(1)
    }
  };
}

function mercadoOposto(m){
  const mapa={
    over05:'under05', under05:'over05',
    over15:'under15', under15:'over15',
    over25:'under25', under25:'over25'
  };
  return mapa[m]||m;
}

function render(){
  const m=mercado.value;
  const m2=mercadoOposto(m);

  tituloPrincipal.innerText=label(m,periodoAtivo);
  tituloSecundario.innerText=label(m2,periodoAtivo);

  renderRanking(rankingPrincipal,m);
  renderRanking(rankingSecundario,m2);
}

function renderRanking(container,met){
  container.innerHTML='';
  const max=Math.max(...dados.map(d=>+d[periodoAtivo][met]));
  [...dados].sort((a,b)=>b[periodoAtivo][met]-a[periodoAtivo][met]).forEach(d=>{
    const v=d[periodoAtivo][met];
    const exibido=met==='mediaGols'?v:`${v}%`;
    container.innerHTML+=`
      <div class="row">
        <div class="label">${d.nome}</div>
        <div class="bar"><div class="fill" style="width:${(v/max)*100}%"></div></div>
        <div class="value">${exibido}</div>
      </div>`;
  });
}

function label(m,p){
  const l={
    mediaGols:'MÃ©dia de gols',
    vitoriasMandante:'VitÃ³rias do mandante',
    vitoriasVisitante:'VitÃ³rias do visitante',
    empates:'Empates',
    zeroZero:'Jogos 0x0',
    over05:'Over 0.5 gols',
    under05:'Under 0.5 gols',
    over15:'Over 1.5 gols',
    under15:'Under 1.5 gols',
    over25:'Over 2.5 gols',
    under25:'Under 2.5 gols'
  };
  return `${l[m]} â€” ${p}`;
}

document.querySelectorAll('.tab').forEach(t=>{
  t.onclick=()=>{
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    periodoAtivo=t.dataset.periodo;
    render();
  };
});

mercado.onchange=render;

carregar();
</script>

</body>
</html>
