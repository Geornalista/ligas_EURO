<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Comparativo Europeu ‚Äî Tempo regulamentar</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

<style>
:root{
  --bg:#0d1b2a;
  --card:#1b263b;
  --accent:#00aaff;
  --text:#e0e1dd;
}
[data-theme="light"]{
  --bg:#f4f6f8;
  --card:#ffffff;
  --accent:#005fcc;
  --text:#1b263b;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:var(--bg);
  color:var(--text);
}
header{
  padding:14px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
h1{
  margin:0;
  font-size:1.1rem;
  color:var(--accent);
}
button,select{
  padding:8px 10px;
  border:none;
  border-radius:10px;
  background:var(--card);
  color:var(--text);
  cursor:pointer;
}
.tabs{
  display:flex;
  gap:6px;
  padding:0 12px 12px;
}
.tabs button{
  flex:1;
  opacity:.6;
}
.tabs button.active{
  background:var(--accent);
  color:#000;
  font-weight:600;
  opacity:1;
}
.controls{
  padding:0 12px 12px;
}
.section{
  padding:12px;
  display:grid;
  gap:12px;
}
@media(min-width:900px){
  .section{grid-template-columns:1fr 1fr}
}
.card{
  background:var(--card);
  border-radius:14px;
  padding:14px;
}
.card h2{
  margin:0 0 10px;
  font-size:.9rem;
  color:var(--accent);
}
.row{
  display:flex;
  gap:8px;
  align-items:center;
  margin:6px 0;
}
.label{
  width:210px;
  font-size:.85rem;
}
.bar{
  flex:1;
  height:8px;
  background:rgba(0,0,0,.25);
  border-radius:4px;
}
.fill{
  height:100%;
  background:var(--accent);
  border-radius:4px;
}
.value{
  width:60px;
  text-align:right;
  font-weight:600;
}
.note{
  opacity:.7;
  font-size:.85rem;
  line-height:1.4;
}
</style>
</head>

<body data-theme="dark">

<header>
  <h1>Comparativo Europeu</h1>
  <button onclick="alternarTema()">üåì</button>
</header>

<div class="tabs">
  <button class="active">Tempo regulamentar</button>
  <button disabled>HT √ó FT</button>
  <button disabled>Mandante √ó Visitante</button>
</div>

<div class="controls">
  <select id="mercado">
    <option value="mediaGols">M√©dia de gols</option>
    <option value="zeroZero">Jogos 0x0</option>
    <option value="over25">Over 2.5 gols</option>
    <option value="under25">Under 2.5 gols</option>
    <option value="vitoriasMandante">Vit√≥rias do mandante</option>
    <option value="vitoriasVisitante">Vit√≥rias do visitante</option>
    <option value="empates">Empates</option>
  </select>
</div>

<div class="section">
  <div class="card">
    <h2 id="tituloA"></h2>
    <div id="rankingA"></div>
  </div>
  <div class="card">
    <h2 id="tituloB"></h2>
    <div id="rankingB"></div>
  </div>
</div>

<script>
/* =========================
   TODAS AS LIGAS
========================= */
const ligas = {
  bundesliga:{nome:'üá©üá™ ALEMANHA',url:'https://www.football-data.co.uk/mmz4281/2526/D1.csv'},
  bundesliga2:{nome:'üá©üá™ ALEMANHA-2',url:'https://www.football-data.co.uk/mmz4281/2526/D2.csv'},
  premier:{nome:'üá¨üáß INGLATERRA',url:'https://www.football-data.co.uk/mmz4281/2526/E0.csv'},
  premier2:{nome:'üá¨üáß INGLATERRA-2',url:'https://www.football-data.co.uk/mmz4281/2526/E1.csv'},
  laliga:{nome:'üá™üá∏ ESPANHA',url:'https://www.football-data.co.uk/mmz4281/2526/SP1.csv'},
  laliga2:{nome:'üá™üá∏ ESPANHA-2',url:'https://www.football-data.co.uk/mmz4281/2526/SP2.csv'},
  seriea:{nome:'üáÆüáπ IT√ÅLIA',url:'https://www.football-data.co.uk/mmz4281/2526/I1.csv'},
  seriea2:{nome:'üáÆüáπ IT√ÅLIA-2',url:'https://www.football-data.co.uk/mmz4281/2526/I2.csv'},
  ligue1:{nome:'üá´üá∑ FRAN√áA',url:'https://www.football-data.co.uk/mmz4281/2526/F1.csv'},
  ligue2:{nome:'üá´üá∑ FRAN√áA-2',url:'https://www.football-data.co.uk/mmz4281/2526/F2.csv'},
  eredivisie:{nome:'üá≥üá± HOLANDA',url:'https://www.football-data.co.uk/mmz4281/2526/N1.csv'},
  portugal:{nome:'üáµüáπ PORTUGAL',url:'https://www.football-data.co.uk/mmz4281/2526/P1.csv'},
  scotland:{nome:'üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø ESC√ìCIA',url:'https://www.football-data.co.uk/mmz4281/2526/SC0.csv'},
  belgium:{nome:'üáßüá™ B√âLGICA',url:'https://www.football-data.co.uk/mmz4281/2526/B1.csv'},
  turkey:{nome:'üáπüá∑ TURQUIA',url:'https://www.football-data.co.uk/mmz4281/2526/T1.csv'},
  greece:{nome:'üá¨üá∑ GR√âCIA',url:'https://www.football-data.co.uk/mmz4281/2526/G1.csv'},

  denmark:{nome:'üá©üá∞ DINAMARCA',url:'https://www.football-data.co.uk/new/DNK.csv',season:'2025/2026'},
  switzerland:{nome:'üá®üá≠ SU√ç√áA',url:'https://www.football-data.co.uk/new/SWZ.csv',season:'2025/2026'},
  norway:{nome:'üá≥üá¥ NORUEGA',url:'https://www.football-data.co.uk/new/NOR.csv',season:'2025'},
  sweden:{nome:'üá∏üá™ SU√âCIA',url:'https://www.football-data.co.uk/new/SWE.csv',season:'2025'}
};

let dados=[];

/* =========================
   CARREGAMENTO
========================= */
async function carregar(){
  dados=[];
  for(const k in ligas){
    const csv = await fetch('https://corsproxy.io/?'+encodeURIComponent(ligas[k].url)).then(r=>r.text());
    let rows = Papa.parse(csv,{header:true}).data;
    if(ligas[k].season){
      rows = rows.filter(r => r.SEASON === ligas[k].season);
    }
    dados.push(calcular(rows, ligas[k].nome));
  }
  render();
}

/* =========================
   C√ÅLCULO FT
========================= */
function calcular(rows,nome){
  const jogos = rows.filter(r=>r.FTR);
  let g=0,z=0,o25=0,vm=0,vv=0,e=0;

  jogos.forEach(j=>{
    const hg=j.FTHG??j.HG??0;
    const ag=j.FTAG??j.AG??0;
    const tg=(+hg)+(+ag);

    g+=tg;
    if(tg===0)z++;
    if(tg>=3)o25++;

    if(j.FTR==='H')vm++;
    else if(j.FTR==='A')vv++;
    else e++;
  });

  const t=jogos.length||1;

  return{
    nome,
    mediaGols:(g/t).toFixed(2),
    zeroZero:(z/t*100).toFixed(1),
    over25:(o25/t*100).toFixed(1),
    under25:((t-o25)/t*100).toFixed(1),
    vitoriasMandante:(vm/t*100).toFixed(1),
    vitoriasVisitante:(vv/t*100).toFixed(1),
    empates:(e/t*100).toFixed(1)
  };
}

/* =========================
   RENDER
========================= */
function render(){
  const m=mercado.value;
  rankingA.innerHTML='';
  rankingB.innerHTML='';

  tituloA.innerText = tituloAFor(m);
  tituloB.innerText = tituloBFor(m);

  // coluna esquerda
  [...dados].sort((a,b)=>b[m]-a[m]).forEach(l=>{
    rankingA.innerHTML+=linha(l.nome,l[m],maxValor(m));
  });

  // coluna direita (ordenada independentemente)
  if(m==='over25'){
    [...dados].sort((a,b)=>b.under25-a.under25).forEach(l=>{
      rankingB.innerHTML+=linha(l.nome,l.under25,100);
    });
  }else if(m==='vitoriasMandante'){
    [...dados].sort((a,b)=>b.vitoriasVisitante-a.vitoriasVisitante).forEach(l=>{
      rankingB.innerHTML+=linha(l.nome,l.vitoriasVisitante,100);
    });
  }else{
    rankingB.innerHTML='<div class="note">Coluna explicativa para contextualizar este mercado no tempo regulamentar.</div>';
  }
}

function maxValor(c){
  return Math.max(...dados.map(d=>+d[c]));
}

function linha(nome,valor,max){
  const pct = (valor/max)*100;
  return `
  <div class="row">
    <div class="label">${nome}</div>
    <div class="bar"><div class="fill" style="width:${pct}%"></div></div>
    <div class="value">${valor}${valor<10?'' : '%'}</div>
  </div>`;
}

function tituloAFor(m){
  return {
    mediaGols:'M√©dia de gols (FT)',
    zeroZero:'Jogos 0x0 (FT)',
    over25:'Over 2.5 gols (FT)',
    under25:'Under 2.5 gols (FT)',
    vitoriasMandante:'Vit√≥rias do mandante (FT)',
    vitoriasVisitante:'Vit√≥rias do visitante (FT)',
    empates:'Empates (FT)'
  }[m];
}

function tituloBFor(m){
  if(m==='over25') return 'Under 2.5 gols (FT)';
  if(m==='vitoriasMandante') return 'Vit√≥rias do visitante (FT)';
  return 'Contexto';
}

mercado.onchange=render;

function alternarTema(){
  document.body.dataset.theme=document.body.dataset.theme==='dark'?'light':'dark';
}

carregar();
</script>

</body>
</html>
